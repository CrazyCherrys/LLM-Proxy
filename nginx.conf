# Nginx é…ç½®æ–‡ä»¶
# åŒ…å«ä»£ç†è®¾ç½®å’Œç¼“å­˜æ§åˆ¶

# WebSocket æ”¯æŒ
map $http_upgrade $connection_upgrade {
    default upgrade;
    ''      close;
}

server {
    listen 80;
    server_name localhost;

    # ä»£ç†é…ç½®å¼€å§‹
    location ^~ /v1/ {
        # è®¾ç½®ä»£ç†ç›®æ ‡æœåŠ¡å™¨
        proxy_pass https://vg.v1api.cc;
        
        # è®¾ç½®ä»£ç†è¯·æ±‚å¤´
        proxy_set_header Host vg.v1api.cc;                    # è®¾ç½®ç›®æ ‡ä¸»æœºå
        proxy_set_header X-Real-IP $remote_addr;                # ä¼ é€’çœŸå®å®¢æˆ·ç«¯IP
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;  # ä¼ é€’ä»£ç†é“¾è·¯ä¿¡æ¯
        proxy_set_header X-Forwarded-Proto $scheme;             # ä¼ é€’åŸå§‹åè®®
        proxy_set_header REMOTE-HOST $remote_addr;              # ä¼ é€’è¿œç¨‹ä¸»æœºä¿¡æ¯
        proxy_set_header Upgrade $http_upgrade;                 # æ”¯æŒWebSocketå‡çº§
        proxy_set_header Connection $connection_upgrade;        # è®¾ç½®WebSocketè¿æ¥
        
        # è®¾ç½®HTTPç‰ˆæœ¬
        proxy_http_version 1.1;
        
        # éšè—ç‰¹å®šå“åº”å¤´
        proxy_hide_header Upgrade;                             # éšè—å‡çº§å¤´
        proxy_hide_header X-Powered-By;                        # éšè—æœåŠ¡å™¨ä¿¡æ¯
        
        # æ·»åŠ ç¼“å­˜çŠ¶æ€å¤´
        add_header X-Cache $upstream_cache_status;             # æ˜¾ç¤ºç¼“å­˜çŠ¶æ€
        
        # é™æ€æ–‡ä»¶ç¼“å­˜æ§åˆ¶
        set $static_file2sMrnVUl 0;                           # åˆå§‹åŒ–é™æ€æ–‡ä»¶æ ‡å¿—
        if ( $uri ~* "\.(gif|png|jpg|css|js|woff|woff2)$" ) { # åŒ¹é…é™æ€æ–‡ä»¶æ‰©å±•å
            set $static_file2sMrnVUl 1;                       # è®¾ç½®é™æ€æ–‡ä»¶æ ‡å¿—
            expires 1m;                                        # è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ä¸º1åˆ†é’Ÿ
        }
        if ( $static_file2sMrnVUl = 0 ) {                     # éé™æ€æ–‡ä»¶
            add_header Cache-Control no-cache;                 # ç¦ç”¨ç¼“å­˜
        }
    }

    # æ ¹è·¯å¾„å¤„ç†
    location = / {
        add_header Content-Type "text/html; charset=utf-8";    # è®¾ç½®å†…å®¹ç±»å‹
        
        # è¿”å›è‡ªå®šä¹‰HTMLé¡µé¢
        return 200 '<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>API</title>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            background: #f8f9fa;
        }
        .container {
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        h1 {
            font-family: "Helvetica Neue", Arial, sans-serif;
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ•Šï¸ APIï¼Œæ™ºèƒ½éšè¡Œ - è®©APIè°ƒç”¨å›å½’ç®€å•æœ¬è´¨</h1>
    </div>
</body>
</html>';
    }
} 